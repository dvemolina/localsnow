# =============================================================================
# LocalSnow Production Environment Variables
# =============================================================================
# INSTRUCTIONS:
# 1. Copy this file: cp .env.production.template .env.production
# 2. Fill in ALL values below with your actual production credentials
# 3. NEVER commit .env.production to version control
# 4. Upload to VPS: scp -P 99 .env.production dvemolina@YOUR_VPS_IP:/home/dvemolina/localsnow/
# =============================================================================

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL credentials for production
# IMPORTANT: Change these from default values!
POSTGRES_DB=localsnow
POSTGRES_USER=localsnow
POSTGRES_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
# Production URL (used for OAuth callbacks, webhooks, absolute URLs)
PROJECT_URL=https://localsnow.org

# Docker image tag (use 'latest' or specific version like 'v1.0.0')
IMAGE_TAG=latest

# =============================================================================
# STRIPE PAYMENT CONFIGURATION (LIVE KEYS!)
# =============================================================================
# Get live keys from: https://dashboard.stripe.com/apikeys
# ⚠️  CRITICAL: Use sk_live_... keys for production, NOT sk_test_...
STRIPE_SECRET_KEY=sk_live_YOUR_LIVE_SECRET_KEY_HERE
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET_HERE

# Stripe Webhook Setup:
# 1. Go to: https://dashboard.stripe.com/webhooks
# 2. Create endpoint: https://localsnow.org/api/webhooks/stripe
# 3. Select events:
#    - checkout.session.completed
#    - payment_intent.payment_failed
# 4. Copy the webhook signing secret above

# =============================================================================
# GOOGLE OAUTH CONFIGURATION
# =============================================================================
# Get from: https://console.cloud.google.com/apis/credentials
# Authorized redirect URI: https://localsnow.org/oauth/google/callback
GOOGLE_CLIENT_ID=YOUR_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YOUR_GOOGLE_CLIENT_SECRET

# Google OAuth Setup:
# 1. Go to: https://console.cloud.google.com/apis/credentials
# 2. Create OAuth 2.0 Client ID (Web application)
# 3. Add authorized redirect URI: https://localsnow.org/oauth/google/callback
# 4. Copy Client ID and Client Secret above

# =============================================================================
# CLOUDFLARE R2 STORAGE CONFIGURATION
# =============================================================================
# For profile images, school logos, qualification documents
# Get from: https://dash.cloudflare.com/ > R2
R2_ACCOUNT_ID=YOUR_CLOUDFLARE_ACCOUNT_ID
R2_ACCESS_KEY_ID=YOUR_R2_ACCESS_KEY_ID
R2_SECRET_ACCESS_KEY=YOUR_R2_SECRET_ACCESS_KEY
R2_BUCKET_NAME=localsnow-uploads
R2_PUBLIC_URL=https://YOUR_BUCKET.r2.cloudflarestorage.com

# R2 Setup:
# 1. Create R2 bucket: localsnow-uploads
# 2. Make bucket PUBLIC (Settings > Public Access > Allow)
# 3. Create API Token with R2 read/write permissions
# 4. Copy credentials above
# 5. Set R2_PUBLIC_URL to your bucket's public URL

# =============================================================================
# CLOUDFLARE TURNSTILE (BOT PROTECTION)
# =============================================================================
# Free CAPTCHA alternative for signup form
# Get from: https://dash.cloudflare.com/ > Turnstile
PUBLIC_TURNSTILE_SITE_KEY=YOUR_TURNSTILE_SITE_KEY
TURNSTILE_SECRET_KEY=YOUR_TURNSTILE_SECRET_KEY

# Turnstile Setup:
# 1. Go to: https://dash.cloudflare.com/ > Turnstile
# 2. Click "Add Site"
# 3. Enter site name and domain (localsnow.org)
# 4. Choose "Managed" mode (recommended)
# 5. Copy Site Key (public) and Secret Key above

# =============================================================================
# N8N WEBHOOK CONFIGURATION
# =============================================================================
# For sending email notifications (signup, bookings, reviews, etc.)
# URL of your n8n webhook endpoint
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/localsnow-emails

# n8n Setup:
# 1. Create n8n workflow for email sending
# 2. Add Webhook trigger node
# 3. Copy webhook URL above
# 4. Configure email templates in n8n

# =============================================================================
# CRON JOB SECURITY
# =============================================================================
# Secret token for authenticating cron job requests
# Generate with: openssl rand -hex 32
CRON_SECRET=GENERATE_RANDOM_SECRET_HERE

# Generate CRON_SECRET on your VPS:
# Run: openssl rand -hex 32
# Paste the output above

# n8n Cron Jobs Required:
# 1. Process Expired Deposits (every 6 hours)
#    - Endpoint: POST https://localsnow.org/api/cron/process-deposits
#    - Header: Authorization: Bearer YOUR_CRON_SECRET
#
# 2. Sync Calendars & Cleanup (every 1 hour)
#    - Endpoint: POST https://localsnow.org/api/cron/availability
#    - Header: Authorization: Bearer YOUR_CRON_SECRET

# =============================================================================
# OPTIONAL: MONITORING & ANALYTICS
# =============================================================================
# Sentry DSN for error tracking (recommended for production)
# Get from: https://sentry.io
# SENTRY_DSN=https://xxxxx@sentry.io/xxxxx

# Google Analytics Measurement ID (optional)
# Get from: https://analytics.google.com
# GA_MEASUREMENT_ID=G-XXXXXXXXXX

# =============================================================================
# SECURITY CHECKLIST BEFORE DEPLOYMENT
# =============================================================================
# [ ] Changed POSTGRES_PASSWORD to a strong random password (min 20 chars)
# [ ] Using Stripe LIVE keys (sk_live_...), not test keys
# [ ] Stripe webhook configured for https://localsnow.org/api/webhooks/stripe
# [ ] Google OAuth redirect URI: https://localsnow.org/oauth/google/callback
# [ ] R2 bucket is PUBLIC and URL is correct
# [ ] Turnstile configured with production domain (localsnow.org)
# [ ] Generated CRON_SECRET with: openssl rand -hex 32
# [ ] n8n webhook URL is accessible and configured
# [ ] n8n cron jobs configured (deposit processing + calendar sync)
# [ ] Verified all environment variables are filled in
# [ ] This file is NOT committed to git (.env.production in .gitignore)
# =============================================================================
